var StyleInputView=Backbone.View.extend({tagName:"option",template:_.template($("#menu-template").html()),initialize:function(){this.render()},render:function(){return this.$el.html(this.template(this.model.toJSON())),this}}),ListStyleView=Backbone.View.extend({tagName:"select",template:_.template($("#input-template").html()),events:{change:"changeStyle"},initialize:function(){this.render()},render:function(){return this.collection.each(function(t){var e=new StyleInputView({model:t});this.$el.append(e.render().el)},this),this},changeStyle:function(t){for(var e=t.currentTarget.value,n=this.collection.length-1;n>=0;n--)if(this.collection.at(n).get("name")===e){var o=this.collection.at(n),i=o.get("typeStart")+window.globalText+o.get("typeEnd"),l=$("#text-input").val().toString(),a=l.replace(window.globalText,i);window.changedText=a,console.log(window.changedText)}}}),FontsView=Backbone.View.extend({el:"#search-font",tagName:"ul",className:"menu-font",events:{"keyup .font-input":"showOptions","click .font-input":"showAllOptions"},initialize:function(){this.input=this.$(".font-input"),this.render(),window.textLength=0},render:function(){return this.collection.each(function(t){var e=new ChooseFontView({model:t});this.$el.append(e.render().el)},this),this},settingModelBool:function(t){for(var e=this.collection.length-1;e>=0;e--)this.collection.at(e).set("selected",t)},showAllOptions:function(){this.settingModelBool(!0)},showOptions:function(t){var e=[],n=$(".font-input").val();this.settingModelBool(!0),0===n.length&&(window.textLength=0),16!==t.keyCode&&8!==t.keyCode&&13!==t.keyCode?window.textLength++:8===t.keyCode&&0!==window.textLength&&window.textLength--;for(var o=window.textLength,i=this.collection.pluck("fontName"),l=i.length-1;l>=0;l--)i[l].substr(0,o)!==n&&i.splice(l,1);for(var l=0;l<i.length;l++)for(var a=0;a<this.collection.length;a++)this.collection.at(a).get("fontName")!==i[l]?this.collection.at(a).set("selected",!1):e.push(a);for(var l=e.length-1;l>=0;l--)this.collection.at(e[l]).set("selected",!0);if(13===t.keyCode&&1===e.length){var h=this.collection.at(e);$(".font-input").val(h.get("fontName"));var s=$("#text-input").val().toString(),c=window.globalText+h.get("startTag")+h.get("endTag"),r=s.replace(window.globalText,c);window.changedText=r}0!==n.length&&0===e.length?this.settingModelBool(!1):0===n.length&&this.settingModelBool(!0)}});